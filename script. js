document.addEventListener('DOMContentLoaded', () => {
  let currentLang = localStorage.getItem('preferredLang') || document.documentElement.lang;

  const langData = {
    ar: {
      exp: "ðŸŒ¼ Ø£ÙƒØ«Ø± Ù…Ù† 10 Ø³Ù†ÙˆØ§Øª Ø®Ø¨Ø±Ø©",
      faqTitle: "Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©",
      visits: "Ø¹Ø¯Ø¯ Ø²ÙŠØ§Ø±Ø§ØªÙƒ: ",
      toggleBtn: "ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©",
      news: [
        "ðŸ“¢ ÙˆØ±Ø´Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙƒ Ø§Ù„Ø±Ø­Ù…Ø§Ù†ÙŠ ØªÙØªØ­ Ø£Ø¨ÙˆØ§Ø¨Ù‡Ø§ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª.",
        "ðŸ”§ Ø®Ø¯Ù…Ø§Øª ØªØµÙ„ÙŠØ­ Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆØ¨Ø£Ø³Ø¹Ø§Ø± Ù…Ù†Ø§ÙØ³Ø©.",
        "ðŸšš ØªÙˆØµÙŠÙ„ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…ØªÙˆÙØ± ÙÙŠ ØªÙˆÙ†Ø³.",
        "ðŸ“± ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±."
      ],
      faq: [
        { q: "ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù‡Ø§Ø² Ù„Ù„Ø¥ØµÙ„Ø§Ø­ØŸ", a: "ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø£Ùˆ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù„ØªØ±ØªÙŠØ¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡." },
        { q: "ÙƒÙ… Ù…Ø¯Ø© Ø§Ù„ØªØµÙ„ÙŠØ­ Ø§Ù„Ù…Ø¹ØªØ§Ø¯Ø©ØŸ", a: "ØªØªØ±Ø§ÙˆØ­ Ø¨ÙŠÙ† ÙŠÙˆÙ… Ø¥Ù„Ù‰ 3 Ø£ÙŠØ§Ù… Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„." },
        { q: "Ù‡Ù„ ØªØ³ØªØ®Ø¯Ù…ÙˆÙ† Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ©ØŸ", a: "Ù†Ø¹Ù…ØŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø¹ Ø£ØµÙ„ÙŠØ© Ø£Ùˆ Ù…ÙƒØ§ÙØ¦Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©." },
        { q: "ÙƒÙŠÙ Ø£ØªØ§Ø¨Ø¹ Ø­Ø§Ù„Ø© Ø¬Ù‡Ø§Ø²ÙŠØŸ", a: "Ù†Ø±Ø³Ù„ Ù„Ùƒ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¹Ø¨Ø± Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨." }
      ],
      days: ['Ø§Ù„Ø£Ø­Ø¯','Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†','Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡','Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡','Ø§Ù„Ø®Ù…ÙŠØ³','Ø§Ù„Ø¬Ù…Ø¹Ø©','Ø§Ù„Ø³Ø¨Øª'],
      months: ['Ø¬Ø§Ù†ÙÙŠ','ÙÙŠÙØ±ÙŠ','Ù…Ø§Ø±Ø³','Ø£ÙØ±ÙŠÙ„','Ù…Ø§ÙŠ','Ø¬ÙˆØ§Ù†','Ø¬ÙˆÙŠÙ„ÙŠØ©','Ø£ÙˆØª','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±']
    },
    fr: {
      exp: "ðŸŒ¼ Plus de 10 ans d'expÃ©rience",
      faqTitle: "FAQ",
      visits: "Nombre de visites: ",
      toggleBtn: "Changer la langue",
      news: [
        "ðŸ“¢ Atelier Electronique MÃ©denine est ouvert dans toute la Tunisie.",
        "ðŸ”§ RÃ©paration d'appareils de qualitÃ© Ã  bon prix.",
        "ðŸšš Livraison disponible dans tout le pays.",
        "ðŸ“± Contactez-nous sur WhatsApp pour toute demande."
      ],
      faq: [
        { q: "Comment envoyer un appareil ?", a: "Par poste ou nous contacter pour le ramassage." },
        { q: "Quel est le dÃ©lai de rÃ©paration ?", a: "Entre 1 et 3 jours selon la panne." },
        { q: "Utilisez-vous des piÃ¨ces d'origine ?", a: "Oui, piÃ¨ces dâ€™origine ou Ã©quivalentes de qualitÃ©." },
        { q: "Comment suivre la rÃ©paration ?", a: "Photos & vidÃ©os envoyÃ©es sur WhatsApp." }
      ],
      days: ['Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'],
      months: ['Janvier','FÃ©vrier','Mars','Avril','Mai','Juin','Juillet','AoÃ»t','Septembre','Octobre','Novembre','DÃ©cembre']
    }
  };

  function applyLanguage(lang) {
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    localStorage.setItem('preferredLang', lang);

    document.getElementById('toggle-lang-btn').textContent = langData[lang].toggleBtn;
    document.getElementById('exp-badge').textContent = langData[lang].exp;
    document.getElementById('faq-title').textContent = langData[lang].faqTitle;

    const faqContainer = document.querySelector('.faq');
    const faqItems = faqContainer.querySelectorAll('.faq-item');
    if (faqItems.length > 0) faqItems.forEach(item => item.remove());

    langData[lang].faq.forEach(({ q, a }) => {
      const div = document.createElement('div');
      div.className = 'faq-item';
      div.innerHTML = `<h3>${q}</h3><div class="answer">${a}</div>`;
      div.onclick = () => div.classList.toggle('open');
      faqContainer.appendChild(div);
    });

    updateVisits();
    rotateNews();
  }

  function updateTime() {
    const now = new Date();
    const lang = currentLang;
    const day = langData[lang].days[now.getDay()];
    const month = langData[lang].months[now.getMonth()];
    const dateStr = `${day}ØŒ ${now.getDate()} ${month}`;
    const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
    document.getElementById('current-time').textContent = `${dateStr} - ${timeStr}`;
  }

  function updateVisits() {
    const key = 'aem-visit-count';
    let count = parseInt(localStorage.getItem(key)) || 0;
    count++;
    localStorage.setItem(key, count);
    document.getElementById('visit-count').textContent = langData[currentLang].visits + count;
  }

  function rotateNews() {
    const ticker = document.getElementById('live-news');
    const news = langData[currentLang].news;
    let index = [43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/KqSMea8/projectnutric/tree/d9969bc5a581652861ec7fc95852f1bcdbf59536/nutric-client%2Fnode_modules_bak%2Fplotly.js%2Flib%2Flocales%2Far-dz.js?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "1")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/tsungkar/test1/tree/a433c299f462bdf460bd7eefc4c33e21c8fae33d/courses%2Frh358%2Frhel8.1%2Fmaterials%2Fdocs%2Fmanaging_storage_devices%2Fjs__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__veGxEiPQW6fkzAPZnAFA23SFz1CyJy2dlu6x8XuHM4s__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "2")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/hadar9/ArtistsFilters/tree/734df7ed19075bffab047d0556a0fcf0ba62b77b/client%2Fsrc%2Fcomponents%2Fheader%2Ftimeanddate%2FTimeNDate.js?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "3")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/YerkoPalma/hypercore-playground/tree/541c7c594fd0e0bf8b9d11c1807a45e6cd65fc84/hyperswarm%2Ffancy%2Findex.js?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "4")[43dcd9a7-70db-4a1f-b0ae-981daa162054](https://github.com/johnsibly/asteroid-party/tree/61647587e107829edd779f5c9fcabe2694e3f059/public%2Findex.js?citationMarker=43dcd9a7-70db-4a1f-b0ae-981daa162054 "5")
let index = 0;
    ticker.textContent = news[index];
    setInterval(() => {
      index = (index + 1) % news.length;
      ticker.textContent = news[index];
    }, 5000);
  }

  // Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©
  document.getElementById('toggle-lang-btn').addEventListener('click', () => {
    currentLang = currentLang === 'ar' ? 'fr' : 'ar';
    applyLanguage(currentLang);
  });

  // Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹
  applyLanguage(currentLang);
  setInterval(updateTime, 1000);
  updateTime();
});
